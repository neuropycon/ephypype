<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>02. Compute ERP &#8212; ephypype 0.5 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          Ephypype</a>
        <span class="navbar-text navbar-version pull-left"><b>0.5</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../auto_examples/index.html">Gallery</a></li>
                <li><a href="../../api.html">API</a></li>
                <li><a href="../../tutorials/index.html">Tutorials</a></li>
                <li><a href="../index.html">Workshop</a></li>
                <li><a href="https://github.com/neuropycon/ephypype">Github</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">02. Compute ERP</a><ul>
<li><a class="reference internal" href="#import-modules">Import modules</a></li>
<li><a class="reference internal" href="#define-data-and-variables">Define data and variables</a></li>
<li><a class="reference internal" href="#extract-events">Extract events</a></li>
<li><a class="reference internal" href="#specify-nodes">Specify Nodes</a><ul>
<li><a class="reference internal" href="#infosource-and-datasource">Infosource and Datasource</a></li>
<li><a class="reference internal" href="#extract-events-node">Extract events Node</a></li>
<li><a class="reference internal" href="#erp-node">ERP Node</a></li>
</ul>
</li>
<li><a class="reference internal" href="#specify-workflows-and-connect-nodes">Specify Workflows and Connect Nodes</a></li>
<li><a class="reference internal" href="#run-workflow">Run workflow</a></li>
<li><a class="reference internal" href="#plot-results">Plot results</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../../_sources/auto_workshop/02_eeg/plot_ERP.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-workshop-02-eeg-plot-erp-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="compute-erp">
<span id="compute-perp"></span><span id="sphx-glr-auto-workshop-02-eeg-plot-erp-py"></span><h1>02. Compute ERP<a class="headerlink" href="#compute-erp" title="Permalink to this heading">¶</a></h1>
<p>This workflow mainly call the
<a class="reference internal" href="../../generated/ephypype.pipelines.create_pipeline_evoked.html#ephypype.pipelines.create_pipeline_evoked" title="ephypype.pipelines.create_pipeline_evoked"><code class="xref py py-func docutils literal notranslate"><span class="pre">ephypype</span> <span class="pre">pipeline</span></code></a>
computing N170 component from cleaned EEG data. The first Node of the workflow
(<a class="reference internal" href="#extract-events-node"><span class="std std-ref">Extract events Node</span></a> Node) extracts the events from raw data. The events
are saved in the Node directory.
In the <a class="reference internal" href="#erp-pipeline"><span class="std std-ref">ERP Node</span></a> the raw data are epoched accordingly to events
extracted in <a class="reference internal" href="#extract-events"><span class="std std-ref">Extract events</span></a> Node.
The evoked datasets are created by averaging the different conditions specified
in <code class="docutils literal notranslate"><span class="pre">json</span></code> file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Authors: Annalisa Pascarella &lt;a.pascarella@iac.cnr.it&gt;</span>
<span class="c1"># License: BSD (3-clause)</span>

<span class="c1"># sphinx_gallery_thumbnail_number = 2</span>
</pre></div>
</div>
<section id="import-modules">
<h2>Import modules<a class="headerlink" href="#import-modules" title="Permalink to this heading">¶</a></h2>
<p>The first step is to import the modules we need in the script. We import
mainly from <a href="https://nipype.readthedocs.io/en/latest/#" target="_blank">nipype</a> and <a href="https://neuropycon.github.io/ephypype/index.html#ephypype target="_blank">ephypype</a> packages.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">os.path</span> <span class="k">as</span> <span class="nn">op</span>

<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">pprint</span>  <span class="c1"># noqa</span>
<span class="kn">import</span> <span class="nn">ephypype</span>

<span class="kn">import</span> <span class="nn">nipype.pipeline.engine</span> <span class="k">as</span> <span class="nn">pe</span>
<span class="kn">from</span> <span class="nn">nipype.interfaces.utility</span> <span class="kn">import</span> <a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.interfaces.base.core.html#nipype.interfaces.base.core.Interface" title="nipype.interfaces.base.core.Interface" class="sphx-glr-backref-module-nipype-interfaces-base-core sphx-glr-backref-type-py-class"><span class="n">Function</span></a>

<span class="kn">from</span> <span class="nn">ephypype.nodes</span> <span class="kn">import</span> <a href="../../generated/ephypype.nodes.create_iterator.html#ephypype.nodes.create_iterator" title="ephypype.nodes.create_iterator" class="sphx-glr-backref-module-ephypype-nodes sphx-glr-backref-type-py-function"><span class="n">create_iterator</span></a><span class="p">,</span> <a href="../../generated/ephypype.nodes.create_datagrabber.html#ephypype.nodes.create_datagrabber" title="ephypype.nodes.create_datagrabber" class="sphx-glr-backref-module-ephypype-nodes sphx-glr-backref-type-py-function"><span class="n">create_datagrabber</span></a>
<span class="kn">from</span> <span class="nn">ephypype.pipelines.preproc_meeg</span> <span class="kn">import</span> <a href="../../generated/ephypype.pipelines.create_pipeline_evoked.html#ephypype.pipelines.create_pipeline_evoked" title="ephypype.pipelines.create_pipeline_evoked" class="sphx-glr-backref-module-ephypype-pipelines sphx-glr-backref-type-py-function"><span class="n">create_pipeline_evoked</span></a>
<span class="kn">from</span> <span class="nn">ephypype.datasets</span> <span class="kn">import</span> <span class="n">fetch_erpcore_dataset</span>
</pre></div>
</div>
<p>Let us fetch the data first. It is around 90 MB download.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ephypype</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">home_dir</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.expanduser" title="os.path.expanduser" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">expanduser</span></a><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">)</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">base_path</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">home_dir</span></a><span class="p">,</span> <span class="s1">&#39;workshop&#39;</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <a href="https://docs.python.org/3/library/os.html#os.mkdir" title="os.mkdir" class="sphx-glr-backref-module-os sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">mkdir</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">base_path</span></a><span class="p">)</span>

<span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;directory </span><span class="si">{}</span><span class="s2"> already exists&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">base_path</span></a><span class="p">))</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a> <span class="o">=</span> <span class="n">fetch_erpcore_dataset</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">base_path</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>directory /home/pasca/workshop already exists
</pre></div>
</div>
</section>
<section id="define-data-and-variables">
<h2>Define data and variables<a class="headerlink" href="#define-data-and-variables" title="Permalink to this heading">¶</a></h2>
<p>Let us specify the variables that are specific for the data analysis (the
main directories where the data are stored, the list of subjects and
sessions, …) and the variable specific for the particular pipeline
(events_id, baseline, …) in a
<a class="reference download external" download="" href="https://github.com/neuropycon/ephypype/tree/master/doc/workshop/eeg/params.json"><code class="xref download docutils literal notranslate"><span class="pre">json</span></code></a> file
(if it is does work, try to go on the github page, and right-click “Save As” on the Raw button)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read experiment params as json</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">params</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/json.html#json.load" title="json.load" class="sphx-glr-backref-module-json sphx-glr-backref-type-py-function"><span class="n">json</span><span class="o">.</span><span class="n">load</span></a><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;params.json&quot;</span><span class="p">))</span>
<a href="https://docs.python.org/3/library/pprint.html#pprint.pprint" title="pprint.pprint" class="sphx-glr-backref-module-pprint sphx-glr-backref-type-py-function"><span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span></a><span class="p">({</span><span class="s1">&#39;parameters&#39;</span><span class="p">:</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">params</span></a><span class="p">[</span><span class="s2">&quot;general&quot;</span><span class="p">]})</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_type</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">params</span></a><span class="p">[</span><span class="s2">&quot;general&quot;</span><span class="p">][</span><span class="s2">&quot;data_type&quot;</span><span class="p">]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject_ids</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">params</span></a><span class="p">[</span><span class="s2">&quot;general&quot;</span><span class="p">][</span><span class="s2">&quot;subject_ids&quot;</span><span class="p">]</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">NJOBS</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">params</span></a><span class="p">[</span><span class="s2">&quot;general&quot;</span><span class="p">][</span><span class="s2">&quot;NJOBS&quot;</span><span class="p">]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">session_ids</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">params</span></a><span class="p">[</span><span class="s2">&quot;general&quot;</span><span class="p">][</span><span class="s2">&quot;session_ids&quot;</span><span class="p">]</span>
<span class="c1"># data_path = params[&quot;general&quot;][&quot;data_path&quot;]</span>

<span class="c1"># ERP params</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ERP_str</span></a> <span class="o">=</span> <span class="s1">&#39;ERP&#39;</span>
<a href="https://docs.python.org/3/library/pprint.html#pprint.pprint" title="pprint.pprint" class="sphx-glr-backref-module-pprint sphx-glr-backref-type-py-function"><span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span></a><span class="p">({</span><span class="s1">&#39;ERP&#39;</span><span class="p">:</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">params</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ERP_str</span></a><span class="p">]})</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events_id</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">params</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ERP_str</span></a><span class="p">][</span><span class="s1">&#39;events_id&#39;</span><span class="p">]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">condition</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">params</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ERP_str</span></a><span class="p">][</span><span class="s1">&#39;condition&#39;</span><span class="p">]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">baseline</span></a> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">params</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ERP_str</span></a><span class="p">][</span><span class="s1">&#39;baseline&#39;</span><span class="p">])</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events_file</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">params</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ERP_str</span></a><span class="p">][</span><span class="s1">&#39;events_file&#39;</span><span class="p">]</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t_min</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">params</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ERP_str</span></a><span class="p">][</span><span class="s1">&#39;tmin&#39;</span><span class="p">]</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t_max</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">params</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ERP_str</span></a><span class="p">][</span><span class="s1">&#39;tmax&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;parameters&#39;: {&#39;NJOBS&#39;: 1,
                &#39;data_path&#39;: &#39;&#39;,
                &#39;data_type&#39;: &#39;eeg&#39;,
                &#39;session_ids&#39;: [&#39;N170&#39;],
                &#39;subject_ids&#39;: [&#39;016&#39;]}}
{&#39;ERP&#39;: {&#39;baseline&#39;: [None, 0],
         &#39;condition&#39;: [&#39;faces&#39;, &#39;car&#39;],
         &#39;events_file&#39;: &#39;*_filt_ica-eve.fif&#39;,
         &#39;events_id&#39;: {&#39;car&#39;: 2, &#39;faces&#39;: 1},
         &#39;tmax&#39;: 0.8,
         &#39;tmin&#39;: -0.2}}
</pre></div>
</div>
</section>
<section id="extract-events">
<span id="id1"></span><h2>Extract events<a class="headerlink" href="#extract-events" title="Permalink to this heading">¶</a></h2>
<p>The first Node of the workflow extract events from the raw data. The events
are extracted using the function <a class="reference external" href="https://mne.tools/stable/generated/mne.events_from_annotations.html">events_from_annotations</a>
of <a class="reference external" href="https://mne.tools/stable/index.html">MNE-python</a> on raw data.
The events are saved in the Node directory.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_events</span><span class="p">(</span><span class="n">raw_ica</span><span class="p">,</span> <span class="n">subject</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    First, we get the ica file from the preprocessing workflow directory, i.e.</span>
<span class="sd">    the cleaned raw data. The events are extracted from raw annotation and are</span>
<span class="sd">    saved in the Node directory.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">subject</span><span class="p">,</span> <span class="n">raw_ica</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">mne</span>

    <span class="n">rename_events</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;201&#39;</span><span class="p">:</span> <span class="s1">&#39;response/correct&#39;</span><span class="p">,</span>
        <span class="s1">&#39;202&#39;</span><span class="p">:</span> <span class="s1">&#39;response/error&#39;</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">180</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">orig_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">40</span><span class="p">:</span>
            <span class="n">new_name</span> <span class="o">=</span> <span class="s1">&#39;stimulus/face/normal&#39;</span>
        <span class="k">elif</span> <span class="mi">41</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">80</span><span class="p">:</span>
            <span class="n">new_name</span> <span class="o">=</span> <span class="s1">&#39;stimulus/car/normal&#39;</span>
        <span class="k">elif</span> <span class="mi">101</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">140</span><span class="p">:</span>
            <span class="n">new_name</span> <span class="o">=</span> <span class="s1">&#39;stimulus/face/scrambled&#39;</span>
        <span class="k">elif</span> <span class="mi">141</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">180</span><span class="p">:</span>
            <span class="n">new_name</span> <span class="o">=</span> <span class="s1">&#39;stimulus/car/scrambled&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">rename_events</span><span class="p">[</span><span class="n">orig_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_name</span>

    <span class="n">raw</span> <span class="o">=</span> <a href="http://mne-tools.github.io/stable/generated/mne.io.read_raw_fif.html#mne.io.read_raw_fif" title="mne.io.read_raw_fif" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_fif</span></a><span class="p">(</span><span class="n">raw_ica</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">events_from_annot</span><span class="p">,</span> <span class="n">event_dict</span> <span class="o">=</span> <a href="http://mne-tools.github.io/stable/generated/mne.events_from_annotations.html#mne.events_from_annotations" title="mne.events_from_annotations" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">events_from_annotations</span></a><span class="p">(</span><span class="n">raw</span><span class="p">)</span>

    <a href="http://mne-tools.github.io/stable/generated/mne.Evoked.html#mne.Evoked" title="mne.Evoked" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">faces</span></a> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <a href="http://mne-tools.github.io/stable/generated/mne.Evoked.html#mne.Evoked" title="mne.Evoked" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">car</span></a> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">event_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">rename_events</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;stimulus/car/normal&#39;</span><span class="p">:</span>
            <a href="http://mne-tools.github.io/stable/generated/mne.Evoked.html#mne.Evoked" title="mne.Evoked" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">car</span><span class="o">.</span><span class="n">append</span></a><span class="p">(</span><span class="n">event_dict</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">rename_events</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;stimulus/face/normal&#39;</span><span class="p">:</span>
            <a href="http://mne-tools.github.io/stable/generated/mne.Evoked.html#mne.Evoked" title="mne.Evoked" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">faces</span><span class="o">.</span><span class="n">append</span></a><span class="p">(</span><span class="n">event_dict</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>

    <span class="n">merged_events</span> <span class="o">=</span> <a href="http://mne-tools.github.io/stable/generated/mne.merge_events.html#mne.merge_events" title="mne.merge_events" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">merge_events</span></a><span class="p">(</span><span class="n">events_from_annot</span><span class="p">,</span> <a href="http://mne-tools.github.io/stable/generated/mne.Evoked.html#mne.Evoked" title="mne.Evoked" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">faces</span></a><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">merged_events</span> <span class="o">=</span> <a href="http://mne-tools.github.io/stable/generated/mne.merge_events.html#mne.merge_events" title="mne.merge_events" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">merge_events</span></a><span class="p">(</span><span class="n">merged_events</span><span class="p">,</span> <a href="http://mne-tools.github.io/stable/generated/mne.Evoked.html#mne.Evoked" title="mne.Evoked" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">car</span></a><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="n">event_file</span> <span class="o">=</span> <span class="n">raw_ica</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.fif&#39;</span><span class="p">,</span> <span class="s1">&#39;-eve.fif&#39;</span><span class="p">)</span>
    <a href="http://mne-tools.github.io/stable/generated/mne.write_events.html#mne.write_events" title="mne.write_events" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">write_events</span></a><span class="p">(</span><span class="n">event_file</span><span class="p">,</span> <span class="n">merged_events</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">event_file</span>
</pre></div>
</div>
</section>
<section id="specify-nodes">
<h2>Specify Nodes<a class="headerlink" href="#specify-nodes" title="Permalink to this heading">¶</a></h2>
<p>Before to create a workflow we have to create the <a class="reference external" href="https://miykael.github.io/nipype_tutorial/notebooks/basic_nodes.html">nodes</a>
that define the workflow itself. In this example the main Nodes are</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">infosource</span></code> is a Node that just distributes values</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">datasource</span></code> is a DataGrabber Node that allows the user to define flexible search patterns which can be parameterized by user defined inputs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">extract_events</span></code> is a Node containing the function <a class="reference internal" href="#extract-events"><span class="std std-ref">Extract events</span></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ERP_pipeline</span></code> is a Node containing the pipeline created by <a class="reference internal" href="../../generated/ephypype.pipelines.create_pipeline_evoked.html#ephypype.pipelines.create_pipeline_evoked" title="ephypype.pipelines.create_pipeline_evoked"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_pipeline_evoked()</span></code></a></p></li>
</ul>
<section id="infosource-and-datasource">
<h3>Infosource and Datasource<a class="headerlink" href="#infosource-and-datasource" title="Permalink to this heading">¶</a></h3>
<p>We create a node to pass input filenames to</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.nodes.html#nipype.pipeline.engine.nodes.Node" title="nipype.pipeline.engine.nodes.Node" class="sphx-glr-backref-module-nipype-pipeline-engine-nodes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">infosource</span></a> <span class="o">=</span> <a href="../../generated/ephypype.nodes.create_iterator.html#ephypype.nodes.create_iterator" title="ephypype.nodes.create_iterator" class="sphx-glr-backref-module-ephypype-nodes sphx-glr-backref-type-py-function"><span class="n">create_iterator</span></a><span class="p">([</span><span class="s1">&#39;subject_id&#39;</span><span class="p">,</span> <span class="s1">&#39;session_id&#39;</span><span class="p">],</span>
                             <span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject_ids</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">session_ids</span></a><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># ``datasource`` node to grab data. The ``template_args`` in this node iterate</span>
<span class="c1"># upon the values in the infosource node</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ica_dir</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a><span class="p">,</span> <span class="s1">&#39;preprocessing_workflow&#39;</span><span class="p">,</span> <span class="s1">&#39;preproc_eeg_pipeline&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">template_path</span></a> <span class="o">=</span> <span class="s2">&quot;_session_id_</span><span class="si">%s</span><span class="s2">_subject_id_</span><span class="si">%s</span><span class="s2">/ica/sub-</span><span class="si">%s</span><span class="s2">_ses-</span><span class="si">%s</span><span class="s2">_*filt_ica.fif&quot;</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">template_args</span></a> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;session_id&#39;</span><span class="p">,</span> <span class="s1">&#39;subject_id&#39;</span><span class="p">,</span> <span class="s1">&#39;subject_id&#39;</span><span class="p">,</span> <span class="s1">&#39;session_id&#39;</span><span class="p">]]</span>
<a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.nodes.html#nipype.pipeline.engine.nodes.Node" title="nipype.pipeline.engine.nodes.Node" class="sphx-glr-backref-module-nipype-pipeline-engine-nodes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">datasource</span></a> <span class="o">=</span> <a href="../../generated/ephypype.nodes.create_datagrabber.html#ephypype.nodes.create_datagrabber" title="ephypype.nodes.create_datagrabber" class="sphx-glr-backref-module-ephypype-nodes sphx-glr-backref-type-py-function"><span class="n">create_datagrabber</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ica_dir</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">template_path</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">template_args</span></a><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="extract-events-node">
<span id="id2"></span><h3>Extract events Node<a class="headerlink" href="#extract-events-node" title="Permalink to this heading">¶</a></h3>
<p>Then, we define the Node that encapsulates <code class="docutils literal notranslate"><span class="pre">get_events</span></code> function</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.nodes.html#nipype.pipeline.engine.nodes.Node" title="nipype.pipeline.engine.nodes.Node" class="sphx-glr-backref-module-nipype-pipeline-engine-nodes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">extract_events</span></a> <span class="o">=</span> <a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.nodes.html#nipype.pipeline.engine.nodes.Node" title="nipype.pipeline.engine.nodes.Node" class="sphx-glr-backref-module-nipype-pipeline-engine-nodes sphx-glr-backref-type-py-class"><span class="n">pe</span><span class="o">.</span><span class="n">Node</span></a><span class="p">(</span>
    <a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.interfaces.base.core.html#nipype.interfaces.base.core.Interface" title="nipype.interfaces.base.core.Interface" class="sphx-glr-backref-module-nipype-interfaces-base-core sphx-glr-backref-type-py-class"><span class="n">Function</span></a><span class="p">(</span><span class="n">input_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;raw_ica&#39;</span><span class="p">,</span> <span class="s1">&#39;subject&#39;</span><span class="p">],</span>
             <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;event_file&#39;</span><span class="p">],</span>
             <span class="n">function</span><span class="o">=</span><span class="n">get_events</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;extract_events&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="erp-node">
<span id="erp-pipeline"></span><h3>ERP Node<a class="headerlink" href="#erp-node" title="Permalink to this heading">¶</a></h3>
<p>Finally, we create the ephypype pipeline computing evoked data which can be
connected to these nodes we created.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.workflows.html#nipype.pipeline.engine.workflows.Workflow" title="nipype.pipeline.engine.workflows.Workflow" class="sphx-glr-backref-module-nipype-pipeline-engine-workflows sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ERP_workflow</span></a> <span class="o">=</span> <a href="../../generated/ephypype.pipelines.create_pipeline_evoked.html#ephypype.pipelines.create_pipeline_evoked" title="ephypype.pipelines.create_pipeline_evoked" class="sphx-glr-backref-module-ephypype-pipelines sphx-glr-backref-type-py-function"><span class="n">create_pipeline_evoked</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_type</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_type</span></a><span class="p">,</span> <span class="n">pipeline_name</span><span class="o">=</span><span class="s2">&quot;ERP_pipeline&quot;</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events_id</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events_id</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">baseline</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">baseline</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">condition</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">condition</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t_min</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t_min</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t_max</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t_max</span></a><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="specify-workflows-and-connect-nodes">
<h2>Specify Workflows and Connect Nodes<a class="headerlink" href="#specify-workflows-and-connect-nodes" title="Permalink to this heading">¶</a></h2>
<p>Now, we create our workflow and specify the <code class="docutils literal notranslate"><span class="pre">base_dir</span></code> which tells
nipype the directory in which to store the outputs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ERP_pipeline_name</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ERP_str</span></a> <span class="o">+</span> <span class="s1">&#39;_workflow&#39;</span>

<a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.workflows.html#nipype.pipeline.engine.workflows.Workflow" title="nipype.pipeline.engine.workflows.Workflow" class="sphx-glr-backref-module-nipype-pipeline-engine-workflows sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">main_workflow</span></a> <span class="o">=</span> <a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.workflows.html#nipype.pipeline.engine.workflows.Workflow" title="nipype.pipeline.engine.workflows.Workflow" class="sphx-glr-backref-module-nipype-pipeline-engine-workflows sphx-glr-backref-type-py-class"><span class="n">pe</span><span class="o">.</span><span class="n">Workflow</span></a><span class="p">(</span><span class="n">name</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ERP_pipeline_name</span></a><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">main_workflow</span><span class="o">.</span><span class="n">base_dir</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a>
</pre></div>
</div>
<p>We then connect the output of <code class="docutils literal notranslate"><span class="pre">infosource</span></code> node to the one of
<code class="docutils literal notranslate"><span class="pre">datasource</span></code>. So, these two nodes taken together can grab data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.workflows.html#nipype.pipeline.engine.workflows.Workflow.connect" title="nipype.pipeline.engine.workflows.Workflow.connect" class="sphx-glr-backref-module-nipype-pipeline-engine-workflows sphx-glr-backref-type-py-method"><span class="n">main_workflow</span><span class="o">.</span><span class="n">connect</span></a><span class="p">(</span><a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.nodes.html#nipype.pipeline.engine.nodes.Node" title="nipype.pipeline.engine.nodes.Node" class="sphx-glr-backref-module-nipype-pipeline-engine-nodes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">infosource</span></a><span class="p">,</span> <span class="s1">&#39;subject_id&#39;</span><span class="p">,</span> <a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.nodes.html#nipype.pipeline.engine.nodes.Node" title="nipype.pipeline.engine.nodes.Node" class="sphx-glr-backref-module-nipype-pipeline-engine-nodes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">datasource</span></a><span class="p">,</span>  <span class="s1">&#39;subject_id&#39;</span><span class="p">)</span>
<a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.workflows.html#nipype.pipeline.engine.workflows.Workflow.connect" title="nipype.pipeline.engine.workflows.Workflow.connect" class="sphx-glr-backref-module-nipype-pipeline-engine-workflows sphx-glr-backref-type-py-method"><span class="n">main_workflow</span><span class="o">.</span><span class="n">connect</span></a><span class="p">(</span><a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.nodes.html#nipype.pipeline.engine.nodes.Node" title="nipype.pipeline.engine.nodes.Node" class="sphx-glr-backref-module-nipype-pipeline-engine-nodes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">infosource</span></a><span class="p">,</span> <span class="s1">&#39;session_id&#39;</span><span class="p">,</span> <a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.nodes.html#nipype.pipeline.engine.nodes.Node" title="nipype.pipeline.engine.nodes.Node" class="sphx-glr-backref-module-nipype-pipeline-engine-nodes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">datasource</span></a><span class="p">,</span> <span class="s1">&#39;session_id&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We connect the output of <code class="docutils literal notranslate"><span class="pre">infosource</span></code> and <code class="docutils literal notranslate"><span class="pre">datasource</span></code> to the input
of <code class="docutils literal notranslate"><span class="pre">extract_events</span></code> node</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.workflows.html#nipype.pipeline.engine.workflows.Workflow.connect" title="nipype.pipeline.engine.workflows.Workflow.connect" class="sphx-glr-backref-module-nipype-pipeline-engine-workflows sphx-glr-backref-type-py-method"><span class="n">main_workflow</span><span class="o">.</span><span class="n">connect</span></a><span class="p">(</span><a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.nodes.html#nipype.pipeline.engine.nodes.Node" title="nipype.pipeline.engine.nodes.Node" class="sphx-glr-backref-module-nipype-pipeline-engine-nodes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">datasource</span></a><span class="p">,</span> <span class="s1">&#39;raw_file&#39;</span><span class="p">,</span> <a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.nodes.html#nipype.pipeline.engine.nodes.Node" title="nipype.pipeline.engine.nodes.Node" class="sphx-glr-backref-module-nipype-pipeline-engine-nodes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">extract_events</span></a><span class="p">,</span> <span class="s1">&#39;raw_ica&#39;</span><span class="p">)</span>
<a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.workflows.html#nipype.pipeline.engine.workflows.Workflow.connect" title="nipype.pipeline.engine.workflows.Workflow.connect" class="sphx-glr-backref-module-nipype-pipeline-engine-workflows sphx-glr-backref-type-py-method"><span class="n">main_workflow</span><span class="o">.</span><span class="n">connect</span></a><span class="p">(</span><a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.nodes.html#nipype.pipeline.engine.nodes.Node" title="nipype.pipeline.engine.nodes.Node" class="sphx-glr-backref-module-nipype-pipeline-engine-nodes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">infosource</span></a><span class="p">,</span> <span class="s1">&#39;subject_id&#39;</span><span class="p">,</span> <a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.nodes.html#nipype.pipeline.engine.nodes.Node" title="nipype.pipeline.engine.nodes.Node" class="sphx-glr-backref-module-nipype-pipeline-engine-nodes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">extract_events</span></a><span class="p">,</span> <span class="s1">&#39;subject&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, we connect the output of <code class="docutils literal notranslate"><span class="pre">infosource</span></code>, <code class="docutils literal notranslate"><span class="pre">datasource</span></code> and
<code class="docutils literal notranslate"><span class="pre">extract_events</span></code> nodes to the input of <code class="docutils literal notranslate"><span class="pre">ERP_pipeline</span></code> node.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.workflows.html#nipype.pipeline.engine.workflows.Workflow.connect" title="nipype.pipeline.engine.workflows.Workflow.connect" class="sphx-glr-backref-module-nipype-pipeline-engine-workflows sphx-glr-backref-type-py-method"><span class="n">main_workflow</span><span class="o">.</span><span class="n">connect</span></a><span class="p">(</span><a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.nodes.html#nipype.pipeline.engine.nodes.Node" title="nipype.pipeline.engine.nodes.Node" class="sphx-glr-backref-module-nipype-pipeline-engine-nodes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">infosource</span></a><span class="p">,</span> <span class="s1">&#39;subject_id&#39;</span><span class="p">,</span>
                      <a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.workflows.html#nipype.pipeline.engine.workflows.Workflow" title="nipype.pipeline.engine.workflows.Workflow" class="sphx-glr-backref-module-nipype-pipeline-engine-workflows sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ERP_workflow</span></a><span class="p">,</span> <span class="s1">&#39;inputnode.sbj_id&#39;</span><span class="p">)</span>
<a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.workflows.html#nipype.pipeline.engine.workflows.Workflow.connect" title="nipype.pipeline.engine.workflows.Workflow.connect" class="sphx-glr-backref-module-nipype-pipeline-engine-workflows sphx-glr-backref-type-py-method"><span class="n">main_workflow</span><span class="o">.</span><span class="n">connect</span></a><span class="p">(</span><a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.nodes.html#nipype.pipeline.engine.nodes.Node" title="nipype.pipeline.engine.nodes.Node" class="sphx-glr-backref-module-nipype-pipeline-engine-nodes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">datasource</span></a><span class="p">,</span> <span class="s1">&#39;raw_file&#39;</span><span class="p">,</span>
                      <a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.workflows.html#nipype.pipeline.engine.workflows.Workflow" title="nipype.pipeline.engine.workflows.Workflow" class="sphx-glr-backref-module-nipype-pipeline-engine-workflows sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ERP_workflow</span></a><span class="p">,</span> <span class="s1">&#39;inputnode.raw&#39;</span><span class="p">)</span>
<a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.workflows.html#nipype.pipeline.engine.workflows.Workflow.connect" title="nipype.pipeline.engine.workflows.Workflow.connect" class="sphx-glr-backref-module-nipype-pipeline-engine-workflows sphx-glr-backref-type-py-method"><span class="n">main_workflow</span><span class="o">.</span><span class="n">connect</span></a><span class="p">(</span><a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.nodes.html#nipype.pipeline.engine.nodes.Node" title="nipype.pipeline.engine.nodes.Node" class="sphx-glr-backref-module-nipype-pipeline-engine-nodes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">extract_events</span></a><span class="p">,</span> <span class="s1">&#39;event_file&#39;</span><span class="p">,</span>
                      <a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.workflows.html#nipype.pipeline.engine.workflows.Workflow" title="nipype.pipeline.engine.workflows.Workflow" class="sphx-glr-backref-module-nipype-pipeline-engine-workflows sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ERP_workflow</span></a><span class="p">,</span> <span class="s1">&#39;inputnode.events_file&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="run-workflow">
<h2>Run workflow<a class="headerlink" href="#run-workflow" title="Permalink to this heading">¶</a></h2>
<p>After we have specified all the nodes and connections of the workflow, the
last step is to run it by calling the <code class="docutils literal notranslate"><span class="pre">run</span></code> method. It’s also possible to
generate static graph representing nodes and connections between them by
calling <code class="docutils literal notranslate"><span class="pre">write_graph</span></code> method.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.workflows.html#nipype.pipeline.engine.workflows.Workflow.write_graph" title="nipype.pipeline.engine.workflows.Workflow.write_graph" class="sphx-glr-backref-module-nipype-pipeline-engine-workflows sphx-glr-backref-type-py-method"><span class="n">main_workflow</span><span class="o">.</span><span class="n">write_graph</span></a><span class="p">(</span><span class="n">graph2use</span><span class="o">=</span><span class="s1">&#39;colored&#39;</span><span class="p">)</span>  <span class="c1"># optional</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&#39;/home/pasca/workshop/ERP_CORE/ERP_workflow/graph.png&#39;
</pre></div>
</div>
<p>Take a moment to pause and notice how the connections
here correspond to how we connected the nodes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>  <span class="c1"># noqa</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">img</span></a> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ERP_pipeline_name</span></a><span class="p">,</span> <span class="s1">&#39;graph.png&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">img</span></a><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_ERP_001.png" srcset="../../_images/sphx_glr_plot_ERP_001.png" alt="plot ERP" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>(-0.5, 535.5, 594.5, -0.5)
</pre></div>
</div>
<p>Finally, we are now ready to execute our workflow.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">main_workflow</span><span class="o">.</span><span class="n">config</span></a><span class="p">[</span><span class="s1">&#39;execution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;remove_unnecessary_outputs&#39;</span><span class="p">:</span> <span class="s1">&#39;false&#39;</span><span class="p">}</span>
<span class="c1"># Run workflow locally on 1 CPU</span>
<a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.workflows.html#nipype.pipeline.engine.workflows.Workflow.run" title="nipype.pipeline.engine.workflows.Workflow.run" class="sphx-glr-backref-module-nipype-pipeline-engine-workflows sphx-glr-backref-type-py-method"><span class="n">main_workflow</span><span class="o">.</span><span class="n">run</span></a><span class="p">(</span><span class="n">plugin</span><span class="o">=</span><span class="s1">&#39;LegacyMultiProc&#39;</span><span class="p">,</span> <span class="n">plugin_args</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;n_procs&#39;</span><span class="p">:</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">NJOBS</span></a><span class="p">})</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;networkx.classes.digraph.DiGraph object at 0x7fdef9f2e410&gt;
</pre></div>
</div>
</section>
<section id="plot-results">
<h2>Plot results<a class="headerlink" href="#plot-results" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mne</span>  <span class="c1"># noqa</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>  <span class="c1"># noqa</span>
<span class="kn">from</span> <span class="nn">ephypype.gather</span> <span class="kn">import</span> <span class="n">get_results</span>  <span class="c1"># noqa</span>

<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked_files</span></a><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">get_results</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">main_workflow</span><span class="o">.</span><span class="n">base_dir</span></a><span class="p">,</span>
                              <a href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.pipeline.engine.base.html#nipype.pipeline.engine.base.EngineBase.name" title="nipype.pipeline.engine.base.EngineBase.name" class="sphx-glr-backref-module-nipype-pipeline-engine-base sphx-glr-backref-type-py-property"><span class="n">main_workflow</span><span class="o">.</span><span class="n">name</span></a><span class="p">,</span> <span class="n">pipeline</span><span class="o">=</span><span class="s1">&#39;compute_evoked&#39;</span><span class="p">)</span>

<span class="k">for</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked_file</span></a> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked_files</span></a><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;*** </span><span class="si">{</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked_file</span></a><span class="si">}</span><span class="s1"> ***</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ave</span></a> <span class="o">=</span> <a href="http://mne-tools.github.io/stable/generated/mne.read_evokeds.html#mne.read_evokeds" title="mne.read_evokeds" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">read_evokeds</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked_file</span></a><span class="p">)</span>
    <a href="http://mne-tools.github.io/stable/generated/mne.Evoked.html#mne.Evoked" title="mne.Evoked" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">faces</span></a><span class="p">,</span> <a href="http://mne-tools.github.io/stable/generated/mne.Evoked.html#mne.Evoked" title="mne.Evoked" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">car</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ave</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ave</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gfp_faces</span></a> <span class="o">=</span> <a href="http://mne-tools.github.io/stable/generated/mne.Evoked.html#mne.Evoked.data" title="mne.Evoked.data" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-property"><span class="n">faces</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">std</span></a><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gfp_car</span></a> <span class="o">=</span> <a href="http://mne-tools.github.io/stable/generated/mne.Evoked.html#mne.Evoked.data" title="mne.Evoked.data" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-property"><span class="n">car</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">std</span></a><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># compare conditions</span>
    <a href="http://mne-tools.github.io/stable/generated/mne.Evoked.html#mne.Evoked" title="mne.Evoked" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">contrast</span></a> <span class="o">=</span> <a href="http://mne-tools.github.io/stable/generated/mne.combine_evoked.html#mne.combine_evoked" title="mne.combine_evoked" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">combine_evoked</span></a><span class="p">([</span><a href="http://mne-tools.github.io/stable/generated/mne.Evoked.html#mne.Evoked" title="mne.Evoked" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">faces</span></a><span class="p">,</span> <a href="http://mne-tools.github.io/stable/generated/mne.Evoked.html#mne.Evoked" title="mne.Evoked" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">car</span></a><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gfp_contrast</span></a> <span class="o">=</span> <a href="http://mne-tools.github.io/stable/generated/mne.Evoked.html#mne.Evoked.data" title="mne.Evoked.data" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-property"><span class="n">contrast</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">std</span></a><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Reproducing the MNE-Python plot style seen above</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="http://mne-tools.github.io/stable/generated/mne.Evoked.html#mne.Evoked.times" title="mne.Evoked.times" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-property"><span class="n">faces</span><span class="o">.</span><span class="n">times</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gfp_faces</span></a> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="http://mne-tools.github.io/stable/generated/mne.Evoked.html#mne.Evoked.times" title="mne.Evoked.times" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-property"><span class="n">car</span><span class="o">.</span><span class="n">times</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gfp_car</span></a> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="http://mne-tools.github.io/stable/generated/mne.Evoked.html#mne.Evoked.times" title="mne.Evoked.times" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-property"><span class="n">contrast</span><span class="o">.</span><span class="n">times</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gfp_contrast</span></a> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Faces&#39;</span><span class="p">,</span> <span class="s1">&#39;Car&#39;</span><span class="p">,</span> <span class="s1">&#39;Contrast&#39;</span><span class="p">])</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_ERP_002.png" srcset="../../_images/sphx_glr_plot_ERP_002.png" alt="plot ERP" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>*** /home/pasca/workshop/ERP_CORE/ERP_workflow/ERP_pipeline/_session_id_N170_subject_id_016/compute_evoked/sub-016_ses-N170_task-N170_eeg_filt_ica-ave.fif ***

Reading /home/pasca/workshop/ERP_CORE/ERP_workflow/ERP_pipeline/_session_id_N170_subject_id_016/compute_evoked/sub-016_ses-N170_task-N170_eeg_filt_ica-ave.fif ...
    Read a total of 1 projection items:
        Average EEG reference (1 x 29) active
    Found the data of interest:
        t =    -200.20 ...     799.80 ms (faces)
        0 CTF compensation matrices available
        nave = 70 - aspect type = 100
Projections have already been applied. Setting proj attribute to True.
Loaded Evoked data is baseline-corrected (baseline: [-0.200195, 0] sec)
    Read a total of 1 projection items:
        Average EEG reference (1 x 29) active
    Found the data of interest:
        t =    -200.20 ...     799.80 ms (car)
        0 CTF compensation matrices available
        nave = 76 - aspect type = 100
Projections have already been applied. Setting proj attribute to True.
Loaded Evoked data is baseline-corrected (baseline: [-0.200195, 0] sec)
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  8.560 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-workshop-02-eeg-plot-erp-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/c5e0ede0a62e20061133605b3f49d877/plot_ERP.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_ERP.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/50feaf72899c2174bc94bb258fca3e70/plot_ERP.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_ERP.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2022, Neuropycon Developers. Last updated on 2022-12-14.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>